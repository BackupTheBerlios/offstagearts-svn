<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html><head>
<meta name="description" content="This cryptography tutorial helps you understand: Setting Up OpenSSL to be used as a CA; Using OpenSSL to generate CA's key pair; Using OpenSSL to self-sign CA's certificate; Using keytool to generate a CSR; Using OpenSSL to sign a CSR; Using keytool to import signed certificates."/> 
<meta name="keywords" content="Cryptography, Digital Security, Free, Tutorial, Book, , OpenSSL, keytool, CSR, Sign, keystore, Certificate"/>
<title>Cryptography Tutorials - Herong's Tutorial Notes - 'OpenSSL' Signing CSR Generated by 'keytool'</title>
<script type="text/javascript" src="_head.js"></script>
<link rel="stylesheet" type="text/css" href="book.css"/>
</head><body>

<div class="hy_body">
<table class="frame" cellspacing="0" cellpadding="0">

<tr><td class="frame_top" colspan="3">
<script type="text/javascript">writeTop("Crypto");</script>
</td></tr>

<tr><td class="frame_left">
<script type="text/javascript">writeLeft("Crypto");</script>
</td>
<td class="frame_center">

<table class="page_border" cellspacing="0" cellpadding="0">
<tr><td></td>
<td>

<table class="page" cellspacing="0" cellpadding="0">
<tr><td>

<table cellspacing="0" cellpadding="0" border="0">
<tr><td align="left" colspan="3"><b>Cryptography Tutorials - Herong's Tutorial Notes</b></td></tr>
<tr><td align="left">Dr. Herong Yang, Version 4.00</td>
<td align="center"></td>
<td align="right">
<script type="text/javascript">writeMenu("Crypto");</script>
</td></tr>
<tr><td class="page_line" colspan="3"><img height="1" width="100%" src="dot.gif" alt=""/></td></tr>
<tr><td class="body" colspan="3">
<!-- begin of body -->

<script type="text/javascript">adsBottom();</script>
<script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>

<table><tr><td class="page_sw">

<script type="text/javascript">adsLeft();</script>
<script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
<script type="text/javascript">writePageLeft("http://www.herongyang.com/crypto");</script>

</td><td class="page_se">

<div class="gg_search"><p><form method="get" action="http://www.google.com/custom" target="_top">
<input type="hidden" name="domains" value="www.herongyang.com"></input>
<input type="hidden" name="client" value="pub-8765173615603734"></input>
<input type="hidden" name="forid" value="1"></input>
<input type="hidden" name="ie" value="ISO-8859-1"></input>
<input type="hidden" name="oe" value="ISO-8859-1"></input>
<input type="hidden" name="cof" value="GALT:#008000;GL:1;DIV:#336699;VLC:663399;AH:center;BGC:FFFFFF;LBGC:336699;ALC:0000FF;LC:0000FF;T:000000;GFNT:0000FF;GIMP:0000FF;FORID:1;"></input>
<input type="hidden" name="hl" value="en"></input>
<input type="text" name="q" size="38" maxlength="255" value=""></input>
<input type="submit" name="sa" value="Search"></input>
<input type="radio" name="sitesearch" value="www.herongyang.com" checked="checked"></input>
<font size="-1" color="#000000">This site</font>
<input type="radio" name="sitesearch" value=""></input>
<font size="-1" color="#000000">Web</font>
<a href="http://www.google.com/">
<img src="http://www.google.com/logos/Logo_25wht.gif"
border="0" alt="Google" style="vertical-align: middle"/></a>
</form><p></div>



<p class="chapter_title" id="OpenSSL_Signing_keytool_CSR.html">
'OpenSSL' Signing CSR Generated by 'keytool'
</p>


<p class="part_list">Part: &nbsp; 
<a href="OpenSSL_Signing_keytool_CSR.html">1</a>&nbsp;
<a href="OpenSSL_Signing_keytool_CSR_2.html">2</a>&nbsp;
<span class="part_list_curr">3</span>&nbsp;
<a href="OpenSSL_Signing_keytool_CSR_4.html">4</a>&nbsp;
<a href="OpenSSL_Signing_keytool_CSR_5.html">5</a>&nbsp;
<a href="OpenSSL_Signing_keytool_CSR_6.html">6</a>&nbsp;
</p>

<p><i>(Continued from previous part...)</i></p>

<p>
As a CA, now I have my private key and my public key certificate. I am ready to sign anything.
The next section describes how someone else can use "keytool" to generated public key and ask me to sign it.
</p>

<p>
One error I had when using the "openssl req -new -x509" command without the "-config openssl.cnf"  
option. "OpenSSL" will give you an error like this: 
</p>
<pre class="block_source">
>openssl req -new -key herong.key -x509 -out herong.crt 
-days 3650
Unable to load config info
Enter pass phrase for herong.key:
unable to find 'distinguished_name' in config
problems making Certificate Request
2252:error:0E06D06A:configuration file routines:
NCONF_get_string:no conf or environment 
variable:conf_lib.c:325:
</pre>


<p class="section_title">
"keytool" Generating Maria's Private Key
</p>

<p>
In this section, let's assume that Maria is using the "keytool", She wants to have her own private key 
to sign documents. But she needs her public key certificate to be signed by me, Herong for two possible 
reasons: 
</p>
<ul>
<li>"keytool" doesn't offer the self-signing certificate function.
</li>
<li>Other people does not trust Maria's signature. 
</li>
</ul>

<p>
So Maria starts to generated her own private key and store it in a "keystore" file. 
This can be done by a single "keytool -genkeypair" command as shown in the following command
session:
</p>
<pre class="block_source">
>java -version

java version "1.6.0_01"
Java(TM) SE Runtime Environment (build 1.6.0_01-b06)
Java HotSpot(TM) Client VM (build 1.6.0_01-b06, mixed mode,
  sharing)
  
>keytool -genkeypair -alias maria_key -keysize 1024 
   -keystore maria.jks -storepass jkspass -keypass keypass
What is your first and last name?
  [Unknown]:  Maria Teresa
What is the name of your organizational unit?
  [Unknown]:  Maria Unit
What is the name of your organization?
  [Unknown]:  Maria Company
What is the name of your City or Locality?
  [Unknown]:  Maria City
What is the name of your State or Province?
  [Unknown]:  Maria State
What is the two-letter country code for this unit?
  [Unknown]:  AT
Is CN=Maria Teresa, OU=Maria Unit, O=Maria Company, L=Maria City, 
ST=Maria State, C=AT correct?
  [no]:  yes
</pre>

<p>
Here is what Maria did:
</p>
<ul>
<li>"java -version" command is used to check the Java version.
</li>
<li>"keytool -genkeypair" command is used to generated a key pair: Maria's private key and Maria's public key.
</li>
<li>"java -version" command is used to check the Java version.
</li>
<li>"-keystore maria.jks" option specifies the keystore file name to hold the key pair.
</li>
<li>"-alias maria_key" option specifies the entry name of the key pair in the keystore file, because keystore file 
can hold multiple key and certificate entries.
</li>
<li>"-keysize 1024" option specifies the key size to be 1024 bits. To bad, "keytool" can not generated 2048-bit keys.
</li>
<li>"-storepass jkspass" option specifies a password to protect the keystore file. 
</li>
<li>"-keypass keypass" option specifies a password to protect "maria_key" entry in the keystore file.
</li>
<li>"keytool" also requires Maria identification information (distinguished name) to be entered at the time
of generating the key pair, which is not really needed for generating a key pair. Distinguished name only needed
when generting certificates.
</li>
</ul>

<p>
Want to confirm that Maria's key pair is in the keystore file? Try this command:
</p>
<pre class="block_source">
>keytool -list -keystore maria.jks -storepass jkspass

Keystore type: JKS
Keystore provider: SUN

Your keystore contains 1 entry

maria_key, Apr 1, 2007, PrivateKeyEntry,
Certificate fingerprint (MD5): 54:5A:E8:77:30:82:B4:EB:C...
</pre>

<p>
Now Maria is ready to generate a CSR (Certificate Sign Request) to ask me as a CA to sign it
as described in the next section. 
</p>


<p><i>(Continued on next part...)</i></p>



<p class="part_list">Part: &nbsp; 
<a href="OpenSSL_Signing_keytool_CSR.html">1</a>&nbsp;
<a href="OpenSSL_Signing_keytool_CSR_2.html">2</a>&nbsp;
<span class="part_list_curr">3</span>&nbsp;
<a href="OpenSSL_Signing_keytool_CSR_4.html">4</a>&nbsp;
<a href="OpenSSL_Signing_keytool_CSR_5.html">5</a>&nbsp;
<a href="OpenSSL_Signing_keytool_CSR_6.html">6</a>&nbsp;
</p>

<script type="text/javascript">adsTop();</script>
<script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>

<script type="text/javascript">showPageFooter("http://www.herongyang.com/crypto", "OpenSSL_Signing_keytool_CSR.html");</script>

</td></tr></table>

<!-- end of body -->
<p></p>
<script type="text/javascript">adsBottom();</script>
<script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>

</td></tr>
<tr><td class="page_line" colspan="3"><img height="1" width="100%" src="dot.gif" alt=""/></td></tr>
<tr><td align="left">Dr. Herong Yang, updated in 2007</td>
<td align="center"></td>
<td align="right"><script type="text/javascript">writeMenu("Crypto");</script></td>
</tr>
<tr><td align="left" colspan="3"><b>Cryptography Tutorials - Herong's Tutorial Notes - 'OpenSSL' Signing CSR Generated by 'keytool'</b></td></tr>
</table>

</td></tr>
</table>

</td>
<td rowspan="1"><img height="100%" width="1" src="dot.gif" alt=""/></td></tr>
</table>

</td>

<td class="frame_right">
<script type="text/javascript">writeRight("Crypto");</script>
</td></tr>
<tr><td class="frame_bottom" colspan="3">
<script type="text/javascript">writeBottom("Crypto");</script>
</td></tr>
</table>
</div>
</body></html>

